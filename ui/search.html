<html>
  <body>
    <form>
      <input id="search-query" type="text" style="width: 100%;display: inline-block;">
      <select id="search-results" size="20" style="width: 100%;display: inline-block;"></select>
    </form>

    <script>
      function onSuccess(queryResults) {
        let searchResults = document.getElementById('search-results');
        // Clear search reults
        while (searchResults.firstChild) {
          searchResults.removeChild(searchResults.firstChild);
        }
        // Add new results
        queryResults.forEach(function(result) {
          var listItem = document.createElement('option');
          listItem.appendChild(document.createTextNode(result));
          searchResults.appendChild(listItem)
        });
      }
      let timeout = null;
      let query = null;
      const debounceTimeMillis = 300;
      function getSearchResultsDebounced(q) {
        query = q;
        clearTimeout(timeout);
        timeout = setTimeout(function() {
          timeout = null;
          google.script.run.withSuccessHandler(onSuccess).getSearchResults(query);
        }, debounceTimeMillis);
      };
      const queryInput = document.getElementById('search-query');
      document.getElementById('search-query').addEventListener('keyup', function(event) {
        getSearchResultsDebounced(queryInput.value);
      });
    </script>
  </body>
</html>